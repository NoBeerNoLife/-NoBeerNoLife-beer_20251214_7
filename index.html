<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ—¥æœ¬ã®ãƒ“ãƒ¼ãƒ«ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ï½œTOP10 & ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä¸€è¦§</title>
  <style>
    :root{
      --bg:#0b0d12;
      --text:#e8ecff;
      --muted:#a9b1d6;
      --line: rgba(255,255,255,.10);
      --shadow: 0 16px 50px rgba(0,0,0,.45);
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif;
      background:
        radial-gradient(1200px 700px at 15% 5%, rgba(255,209,102,.16), transparent 60%),
        radial-gradient(900px 600px at 80% 20%, rgba(123,223,242,.12), transparent 60%),
        var(--bg);
      color: var(--text);
    }
    a{ color:inherit; text-decoration:none; }
    .container{ width:min(1100px, 92vw); margin: 0 auto; }

    .site-header{
      position: sticky; top:0; z-index:50;
      backdrop-filter: blur(14px);
      background: rgba(11,13,18,.6);
      border-bottom: 1px solid var(--line);
      padding: 14px 0;
    }
    .site-header .container{
      display:flex; gap:16px; align-items:center; justify-content:space-between;
    }
    .brand{ display:flex; gap:12px; align-items:center; }
    .logo{
      width:40px; height:40px; display:grid; place-items:center;
      border:1px solid var(--line);
      border-radius: 12px;
      background: rgba(255,255,255,.04);
    }
    .brand h1{ margin:0; font-size:18px; letter-spacing:.02em; }
    .brand .sub{ margin:2px 0 0; color:var(--muted); font-size:12px; }

    .nav{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end; }
    .nav-link{
      padding:10px 12px;
      border-radius: 12px;
      border: 1px solid transparent;
      color: var(--muted);
      cursor:pointer;
      background: transparent;
      font: inherit;
    }
    .nav-link:hover{ border-color: var(--line); color: var(--text); }
    .nav-link.is-active{
      background: rgba(255,255,255,.05);
      border-color: var(--line);
      color: var(--text);
    }

    .btn{
      cursor:pointer;
      padding: 10px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      color: var(--text);
      box-shadow: 0 10px 22px rgba(0,0,0,.22);
      font: inherit;
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:active{ transform: translateY(0); }

    .btn-primary{
      background: linear-gradient(180deg, rgba(255,209,102,.18), rgba(255,209,102,.06));
    }
    .btn-outline{
      background: transparent;
      border-color: rgba(255,255,255,.18);
    }

    main{ padding: 26px 0 60px; }

    .hero{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      align-items: stretch;
      margin-top: 10px;
    }
    @media (max-width: 860px){ .hero{ grid-template-columns: 1fr; } }

    .hero-media{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      min-height: 260px;
      background:
        linear-gradient(180deg, rgba(0,0,0,.05), rgba(0,0,0,.55)),
        radial-gradient(800px 320px at 20% 25%, rgba(123,223,242,.22), transparent 60%),
        radial-gradient(800px 320px at 75% 40%, rgba(255,209,102,.20), transparent 60%),
        rgba(0,0,0,.2);
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .hero-media::after{
      content:"è‹¥ã„æ—¥æœ¬ã®ç”·å¥³ãŒä¹¾æ¯ã—ã¦ã„ã‚‹ç”»åƒURLã‚’è¨­å®šã§ãã¾ã™ï¼ˆä¸‹ã®ã€Œç”»åƒURLã€ï¼‰";
      position:absolute;
      left:14px; bottom:12px;
      font-size:12px;
      color: rgba(232,236,255,.85);
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.14);
      padding: 8px 10px;
      border-radius: 12px;
      max-width: calc(100% - 28px);
    }
    .hero-body{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      padding: 18px;
      box-shadow: var(--shadow);
    }
    .hero-body h2{ margin: 4px 0 8px; font-size: 22px; }
    .hero-body p{ margin: 0; color: var(--muted); line-height: 1.6; }

    .hero-actions{ display:flex; gap:10px; margin-top: 14px; flex-wrap: wrap; }

    .panel{
      margin-top: 18px;
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,.03);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panel-head{
      padding: 14px 16px;
      display:flex;
      gap:12px;
      align-items: baseline;
      justify-content: space-between;
      border-bottom: 1px solid var(--line);
      background: rgba(0,0,0,.15);
      flex-wrap:wrap;
    }
    .panel-head h3{ margin:0; font-size: 16px; }
    .hint{ color: var(--muted); font-size: 12px; }

    .grid{
      padding: 16px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
    }
    @media (max-width: 980px){ .grid{ grid-template-columns: repeat(2,1fr);} }
    @media (max-width: 620px){ .grid{ grid-template-columns: 1fr;} }

    .card{
      border: 1px solid var(--line);
      border-radius: 18px;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    }
    .card-media{
      height: 150px;
      background:
        radial-gradient(600px 220px at 20% 20%, rgba(123,223,242,.25), transparent 60%),
        radial-gradient(600px 220px at 80% 40%, rgba(255,209,102,.22), transparent 60%),
        rgba(0,0,0,.2);
      background-size: cover;
      background-position: center;
      border-bottom: 1px solid var(--line);
    }
    .card-body{ padding: 12px; }
    .rank{
      display:inline-flex; gap:8px; align-items:center;
      font-weight: 700;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,209,102,.12);
      border: 1px solid rgba(255,209,102,.25);
    }
    .card h4{ margin: 10px 0 6px; font-size: 15px; }
    .desc{ margin: 0 0 10px; color: var(--muted); font-size: 12px; line-height: 1.5; min-height: 38px; }
    .meta{
      display:flex; flex-wrap: wrap; gap: 8px;
      color: var(--muted);
      font-size: 12px;
    }
    .badge{
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
    }
    .card-actions{
      margin-top: 12px;
      display:flex; gap: 10px; flex-wrap: wrap;
    }

    .list{ padding: 8px; }
    .row{
      display:grid;
      grid-template-columns: 80px 1fr 260px;
      gap: 12px;
      align-items:center;
      padding: 12px;
      border-bottom: 1px solid var(--line);
    }
    @media (max-width: 860px){
      .row{ grid-template-columns: 60px 1fr; }
      .row-right{ grid-column: 1 / -1; justify-content:flex-start; }
    }
    .row:last-child{ border-bottom: none; }
    .row-rank{ display:flex; flex-direction: column; gap:6px; align-items:flex-start; }
    .rank-num{ font-weight: 800; font-size: 16px; }
    .thumb{
      width: 100%;
      height: 46px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: rgba(0,0,0,.2);
      background-size: cover;
      background-position: center;
    }
    .row h4{ margin:0; font-size: 14px; }
    .row p{ margin: 4px 0 0; color: var(--muted); font-size: 12px; line-height: 1.5; }
    .row-right{ display:flex; justify-content:flex-end; gap: 8px; flex-wrap: wrap; }

    .muted{ color: var(--muted); }

    .modal{ position: fixed; inset:0; display:none; }
    .modal[aria-hidden="false"]{ display:block; }
    .modal-backdrop{ position:absolute; inset:0; background: rgba(0,0,0,.55); }
    .modal-card{
      position: relative;
      width: min(760px, 92vw);
      margin: 6vh auto;
      border-radius: 18px;
      border: 1px solid var(--line);
      background: rgba(18,22,37,.96);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .modal-head{
      display:flex; align-items:center; justify-content:space-between;
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
    }
    .modal-head h3{ margin:0; font-size: 15px; }
    .icon-btn{
      cursor:pointer;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      font: inherit;
    }
    .modal-body{ padding: 14px; }
    .form{ display:grid; gap: 10px; }
    .form-row{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    @media (max-width: 620px){ .form-row{ grid-template-columns: 1fr; } }

    label{ display:grid; gap: 6px; font-size: 12px; color: var(--muted); }
    input, select, textarea{
      width: 100%;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      padding: 10px 12px;
      color: var(--text);
      outline: none;
      font: inherit;
    }
    textarea{ resize: vertical; }
    .form-actions{ display:flex; gap: 10px; flex-wrap: wrap; align-items:center; }
    .output{
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px;
      background: rgba(0,0,0,.15);
    }
    .output-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom: 8px; }

    .hidden{ display:none !important; }

    .config{
      display:grid; gap:10px;
      margin-top: 14px;
      padding: 12px;
      border: 1px dashed rgba(255,255,255,.18);
      border-radius: 14px;
      background: rgba(0,0,0,.12);
    }
    .config .row2{
      display:grid; grid-template-columns: 1fr auto;
      gap:10px;
    }
    @media (max-width: 620px){ .config .row2{ grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <div class="brand">
        <div class="logo">ğŸº</div>
        <div>
          <h1>æ—¥æœ¬ã®ãƒ“ãƒ¼ãƒ«ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³</h1>
          <p class="sub">æ¯æœˆæ›´æ–°ï¼šãƒã‚¸ãƒ†ã‚£ãƒ–ãªå£° Ã— å£²ä¸Šã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°</p>
        </div>
      </div>

      <nav class="nav">
        <button id="tabTop" class="nav-link is-active" type="button">TOP10</button>
        <button id="tabAll" class="nav-link" type="button">ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä¸€è¦§</button>
        <button id="monthBtn" class="btn" type="button" title="è¡¨ç¤ºæœˆã‚’åˆ‡ã‚Šæ›¿ãˆ">
          è¡¨ç¤ºæœˆï¼š<span id="monthLabel"></span>
        </button>
        <button id="openAgentFromHeader" class="btn btn-primary" type="button">äºˆç´„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</button>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div id="heroMedia" class="hero-media" role="img" aria-label="è‹¥ã„æ—¥æœ¬ã®ç”·å¥³ãŒãƒ“ãƒ¼ãƒ«ã§ä¹¾æ¯ã—ã¦ã„ã‚‹æ˜ã‚‹ã„ã‚¤ãƒ¡ãƒ¼ã‚¸"></div>

      <div class="hero-body">
        <h2>ä»Šæœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>
        <p>
          ä¸¦ã³é †ã¯ã€Œãƒã‚¸ãƒ†ã‚£ãƒ–ãªå£°ï¼ˆä»Šæœˆï¼‰ã€ãŒå¤šã„é †ã€åŒæ•°ãªã‚‰ã€Œå£²ä¸Šï¼ˆä»Šæœˆï¼‰ã€ãŒé«˜ã„é †ã§ã™ã€‚<br/>
          GitHub Pages ã§ <strong>index.html 1ãƒ•ã‚¡ã‚¤ãƒ«ã ã‘</strong> ã§ã‚‚å‹•ãã‚ˆã†ã«ã€CSS/JSã‚’ã“ã®ä¸­ã«å…¨éƒ¨å…¥ã‚Œã¦ã„ã¾ã™ã€‚
        </p>

        <div class="hero-actions">
          <button class="btn btn-outline" type="button" id="openAgentFromHero">äºˆç´„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’é–‹ã</button>
          <button class="btn" type="button" id="scrollToList">ä¸€è¦§ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«</button>
        </div>

        <div class="config">
          <div class="muted" style="font-size:12px;">
            ç”»åƒã®æŒ‡å®šï¼šã‚ãªãŸãŒç”¨æ„ã—ãŸã€Œä¹¾æ¯ã—ã¦ã„ã‚‹ã€ç”»åƒURLã‚’å…¥ã‚Œã‚‹ã¨ãƒˆãƒƒãƒ—èƒŒæ™¯ã«ãªã‚Šã¾ã™ï¼ˆURLã¯ https:// ã§å§‹ã¾ã‚‹ã‚‚ã®ï¼‰ã€‚
          </div>
          <div class="row2">
            <input id="heroUrl" type="url" placeholder="ä¾‹ï¼šhttps://.../cheers.jpgï¼ˆç”»åƒURLï¼‰" />
            <button id="applyHero" class="btn" type="button">é©ç”¨</button>
          </div>
        </div>
      </div>
    </section>

    <section id="sectionTop10" class="panel">
      <div class="panel-head">
        <h3>TOP10 åº—èˆ—</h3>
        <div class="hint">ä¸¦ã³é †ï¼šãƒã‚¸ãƒ†ã‚£ãƒ–ï¼ˆé™é †ï¼‰â†’ å£²ä¸Šï¼ˆé™é †ï¼‰</div>
      </div>
      <div id="top10Grid" class="grid"></div>
    </section>

    <section id="sectionAll" class="panel hidden">
      <div class="panel-head">
        <h3>å…¨åº—èˆ—ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h3>
        <div class="hint">11ä½ä»¥ä¸‹ã‚‚å«ã‚ã¦è¡¨ç¤ºã—ã¾ã™</div>
      </div>
      <div id="rankList" class="list"></div>
    </section>
  </main>

  <div id="agentModal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="äºˆç´„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ">
      <div class="modal-head">
        <h3>äºˆç´„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</h3>
        <button class="icon-btn" type="button" data-close="1" aria-label="é–‰ã˜ã‚‹">âœ•</button>
      </div>

      <div class="modal-body">
        <p class="muted" style="margin-top:0;">
          åº—èˆ—ã‚’é¸ã‚“ã§æ—¥æ™‚ãƒ»äººæ•°ã‚’å…¥ã‚Œã‚‹ã¨ã€äºˆç´„ãƒšãƒ¼ã‚¸ã‚’é–‹ãã¤ã¤ã€äºˆç´„ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚ä½œã‚Šã¾ã™ï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰ã€‚
        </p>

        <div class="form">
          <label>
            åº—èˆ—
            <select id="agentShopSelect"></select>
          </label>

          <div class="form-row">
            <label>
              æ—¥ä»˜
              <input id="agentDate" type="date" />
            </label>
            <label>
              æ™‚é–“
              <input id="agentTime" type="time" />
            </label>
          </div>

          <div class="form-row">
            <label>
              äººæ•°
              <input id="agentPeople" type="number" min="1" value="2" />
            </label>
            <label>
              ãŠåå‰ï¼ˆä»»æ„ï¼‰
              <input id="agentName" type="text" placeholder="ä¾‹ï¼šå¤§å±±" />
            </label>
          </div>

          <label>
            è¦æœ›ï¼ˆä»»æ„ï¼‰
            <input id="agentNotes" type="text" placeholder="ä¾‹ï¼šã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å¸Œæœ›ã€é™ã‹ãªå¸­å¸Œæœ› ãªã©" />
          </label>

          <div class="form-actions">
            <button id="agentMakeMsg" class="btn btn-outline" type="button">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ</button>
            <button id="agentGoReserve" class="btn btn-primary" type="button">äºˆç´„ãƒšãƒ¼ã‚¸ã‚’é–‹ã</button>
          </div>

          <div class="output">
            <div class="output-head">
              <strong>äºˆç´„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰</strong>
              <button id="agentCopy" class="btn" type="button">ã‚³ãƒ”ãƒ¼</button>
            </div>
            <textarea id="agentMessage" rows="6" placeholder="ã“ã“ã«ç”Ÿæˆã•ã‚Œã¾ã™"></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer style="border-top:1px solid var(--line); background: rgba(0,0,0,.18); padding: 18px 0; margin-top: 30px;">
    <div class="container" style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap;">
      <small>Â© Beer Restaurants Japan</small>
      <small class="muted">â€»ã“ã®ãƒšãƒ¼ã‚¸ã¯ãƒ‡ãƒ¢ã€‚åº—èˆ—ãƒ‡ãƒ¼ã‚¿ã¯ãƒšãƒ¼ã‚¸å†…ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚</small>
    </div>
  </footer>

  <script>
    const SHOPS = [
      { id:"tokyo-001", name:"ã‚¯ãƒ©ãƒ•ãƒˆãƒ“ãƒ¼ãƒ«é£Ÿå ‚ æ±äº¬", desc:"å›½ç”£ã‚¯ãƒ©ãƒ•ãƒˆä¸­å¿ƒã€‚é£²ã¿æ¯”ã¹ã‚»ãƒƒãƒˆã¨å­£ç¯€ã®ãƒšã‚¢ãƒªãƒ³ã‚°ãŒäººæ°—ã€‚", budget:"Â¥2,500ã€œÂ¥4,500", url:"https://example.com/beer-1", reserveUrl:"https://example.com/beer-1/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:128,sales:9800000},"2025-11":{positive:96,sales:8700000} } },
      { id:"tokyo-002", name:"ãƒ“ã‚¢ãƒ›ãƒ¼ãƒ«éŠ€åº§", desc:"ç‹é“ã®ãƒ“ã‚¢ãƒ›ãƒ¼ãƒ«ã€‚ãƒ“ãƒ¼ãƒ«ã«åˆã†è‚‰æ–™ç†ã¨è½ã¡ç€ã„ãŸé›°å›²æ°—ã€‚", budget:"Â¥3,000ã€œÂ¥6,000", url:"https://example.com/beer-2", reserveUrl:"https://example.com/beer-2/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:110,sales:11200000},"2025-11":{positive:104,sales:9800000} } },
      { id:"tokyo-003", name:"ä¸‹ç”ºã‚¿ãƒƒãƒ—ãƒ«ãƒ¼ãƒ ", desc:"ã‚¿ãƒƒãƒ—æ•°20ã€‚è»½ã‚ã‹ã‚‰è‹¦å‘³ã¾ã§å¹…åºƒãã€åˆå¿ƒè€…ã§ã‚‚é¸ã³ã‚„ã™ã„ã€‚", budget:"Â¥2,000ã€œÂ¥4,000", url:"https://example.com/beer-3", reserveUrl:"https://example.com/beer-3/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:140,sales:7600000},"2025-11":{positive:122,sales:7900000} } },
      { id:"yokohama-001", name:"æ¸¯ç”ºãƒ–ãƒªãƒ¥ãƒ¯ãƒªãƒ¼&ã‚°ãƒªãƒ«", desc:"é†¸é€ æ‰€ä½µè¨­ã€‚ã§ããŸã¦ã®é¦™ã‚Šã‚’æ¥½ã—ã‚ã‚‹ã€‚", budget:"Â¥3,500ã€œÂ¥6,500", url:"https://example.com/beer-9", reserveUrl:"https://example.com/beer-9/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:101,sales:10400000} } },
      { id:"osaka-001", name:"å¤§é˜ªã‚¯ãƒ©ãƒ•ãƒˆæ¨ªä¸", desc:"å¤§é˜ªåç‰©ã¨ã‚¯ãƒ©ãƒ•ãƒˆã®çµ„ã¿åˆã‚ã›ã€‚è³‘ã‚„ã‹ã«æ¥½ã—ã‚ã‚‹ã€‚", budget:"Â¥2,500ã€œÂ¥5,000", url:"https://example.com/beer-4", reserveUrl:"https://example.com/beer-4/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:88,sales:9100000} } },
      { id:"nagoya-001", name:"åå¤å±‹ãƒ“ã‚¢ã‚­ãƒƒãƒãƒ³", desc:"æ‰‹ç¾½å…ˆã¨é»’ãƒ“ãƒ¼ãƒ«ã®ç›¸æ€§ãŒè©•åˆ¤ã€‚ã‚°ãƒ«ãƒ¼ãƒ—ã«ã‚‚ã€‚", budget:"Â¥2,500ã€œÂ¥4,800", url:"https://example.com/beer-8", reserveUrl:"https://example.com/beer-8/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:83,sales:7000000} } },
      { id:"kyoto-001", name:"äº¬éƒ½ãƒ“ã‚¢ãƒ€ã‚¤ãƒ‹ãƒ³ã‚°", desc:"å’Œã®å°çš¿ã¨ãƒ“ãƒ¼ãƒ«ã€‚é¦™ã‚Šç³»ã‚¨ãƒ¼ãƒ«ãŒäººæ°—ã€‚", budget:"Â¥3,000ã€œÂ¥5,500", url:"https://example.com/beer-5", reserveUrl:"https://example.com/beer-5/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:92,sales:6900000} } },
      { id:"kobe-001", name:"ç¥æˆ¸ãƒ“ã‚¢ãƒ†ãƒ©ã‚¹", desc:"å¤œæ™¯Ã—ã‚¯ãƒ©ãƒ•ãƒˆã€‚ãƒ‡ãƒ¼ãƒˆå‘ã‘ã®é›°å›²æ°—ã€‚", budget:"Â¥3,000ã€œÂ¥6,000", url:"https://example.com/beer-10", reserveUrl:"https://example.com/beer-10/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:73,sales:7800000} } },
      { id:"fukuoka-001", name:"åšå¤šã‚¿ãƒƒãƒ—ã‚¹ã‚¿ãƒ³ãƒ‰", desc:"è»½ã1æ¯ã‹ã‚‰ã€‚ãƒ•ãƒ¼ãƒ‰ã‚‚å……å®Ÿã€ã‚µã‚¯é£²ã¿ã«å¼·ã„ã€‚", budget:"Â¥1,800ã€œÂ¥3,500", url:"https://example.com/beer-6", reserveUrl:"https://example.com/beer-6/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:77,sales:5200000} } },
      { id:"sapporo-001", name:"æœ­å¹Œéº¦é…’å€¶æ¥½éƒ¨", desc:"åŒ—æµ·é“é£ŸæÃ—ãƒ©ã‚¬ãƒ¼ã€‚å¯’ã„å­£ç¯€ã®æ¸©ã‹ã„æ–™ç†ã‚‚â—", budget:"Â¥2,800ã€œÂ¥5,500", url:"https://example.com/beer-7", reserveUrl:"https://example.com/beer-7/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:69,sales:6100000} } },
      ...Array.from({length:15}).map((_,i)=>{ const n=i+11; return { id:`sample-${String(n).padStart(3,"0")}`, name:`ã‚µãƒ³ãƒ—ãƒ«ãƒ“ã‚¢ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ ${n}`, desc:"ã‚µãƒ³ãƒ—ãƒ«èª¬æ˜ï¼šæ–™ç†ã¨ãƒ“ãƒ¼ãƒ«ã®ãƒšã‚¢ãƒªãƒ³ã‚°ãŒæ¥½ã—ã‚ã¾ã™ã€‚", budget:"Â¥2,000ã€œÂ¥5,000", url:"https://example.com/sample", reserveUrl:"https://example.com/sample/reserve", image:"", monthlyMetrics:{ "2025-12":{positive:40+(n%20)*3, sales:3000000+(n%10)*500000} } }; })
    ];

    const MONTHS_AVAILABLE = getAllMonths(SHOPS);
    let currentMonth = loadMonthPreference() || (MONTHS_AVAILABLE[0] || getThisMonth());

    function getThisMonth(){ const d=new Date(); return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`; }
    function getAllMonths(shops){ const set=new Set(); shops.forEach(s=>Object.keys(s.monthlyMetrics||{}).forEach(k=>set.add(k))); return Array.from(set).sort((a,b)=>a>b?-1:1); }
    function metricOf(shop, month){ const mm=shop.monthlyMetrics?.[month]; return {positive:mm?.positive??0, sales:mm?.sales??0}; }
    function sortByRule(shops, month){ return [...shops].sort((a,b)=>{ const A=metricOf(a,month), B=metricOf(b,month); if(B.positive!==A.positive) return B.positive-A.positive; return B.sales-A.sales; }); }
    function formatYen(num){ try{ return new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",maximumFractionDigits:0}).format(num);}catch{ return `Â¥${Math.round(num).toLocaleString("ja-JP")}`; } }
    function escapeHTML(str){ return String(str??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"); }
    function setMonthLabel(){ const label=document.getElementById("monthLabel"); if(label) label.textContent=currentMonth; }
    function saveMonthPreference(m){ localStorage.setItem("beer_rank_month", m); }
    function loadMonthPreference(){ return localStorage.getItem("beer_rank_month"); }

    function renderTop10(){
      const grid=document.getElementById("top10Grid");
      const ranked=sortByRule(SHOPS,currentMonth).slice(0,10);
      grid.innerHTML = ranked.map((shop,idx)=>{ const m=metricOf(shop,currentMonth); const bg=shop.image?`style="background-image:url('${shop.image}')"`:""; return `
        <article class="card">
          <div class="card-media" ${bg}></div>
          <div class="card-body">
            <span class="rank">#${idx+1} / TOP10</span>
            <h4>${escapeHTML(shop.name)}</h4>
            <p class="desc">${escapeHTML(shop.desc)}</p>
            <div class="meta">
              <span class="badge">äºˆç®—ï¼š${escapeHTML(shop.budget)}</span>
              <span class="badge">å£°ï¼š${m.positive.toLocaleString("ja-JP")}</span>
              <span class="badge">å£²ä¸Šï¼š${formatYen(m.sales)}</span>
            </div>
            <div class="card-actions">
              <a class="btn btn-outline" href="${shop.url}" target="_blank" rel="noopener">ãŠåº—URL</a>
              <button class="btn btn-primary" type="button" data-open-agent="${shop.id}">äºˆç´„ã™ã‚‹</button>
            </div>
          </div>
        </article>`; }).join("");
    }

    function renderRankList(){
      const list=document.getElementById("rankList");
      const ranked=sortByRule(SHOPS,currentMonth);
      list.innerHTML = ranked.map((shop,i)=>{ const m=metricOf(shop,currentMonth); const bg=shop.image?`style="background-image:url('${shop.image}')"`:""; return `
        <div class="row">
          <div class="row-rank">
            <div class="rank-num">#${i+1}</div>
            <div class="thumb" ${bg}></div>
          </div>
          <div class="row-mid">
            <h4>${escapeHTML(shop.name)}</h4>
            <p>${escapeHTML(shop.desc)}</p>
            <div class="meta" style="margin-top:8px">
              <span class="badge">äºˆç®—ï¼š${escapeHTML(shop.budget)}</span>
              <span class="badge">å£°ï¼š${m.positive.toLocaleString("ja-JP")}</span>
              <span class="badge">å£²ä¸Šï¼š${formatYen(m.sales)}</span>
            </div>
          </div>
          <div class="row-right">
            <a class="btn btn-outline" href="${shop.url}" target="_blank" rel="noopener">ãŠåº—URL</a>
            <button class="btn btn-primary" type="button" data-open-agent="${shop.id}">äºˆç´„ã™ã‚‹</button>
          </div>
        </div>`; }).join("");
    }

    function rerender(){ renderTop10(); renderRankList(); }

    function setTab(which){
      const top = which === "top";
      document.getElementById("tabTop").classList.toggle("is-active", top);
      document.getElementById("tabAll").classList.toggle("is-active", !top);
      document.getElementById("sectionTop10").classList.toggle("hidden", !top);
      document.getElementById("sectionAll").classList.toggle("hidden", top);
    }

    function setupMonthSwitcher(){
      const btn=document.getElementById("monthBtn");
      setMonthLabel();
      btn.addEventListener("click", ()=>{
        if(MONTHS_AVAILABLE.length===0) return alert("æœˆæ¬¡ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        const idx=MONTHS_AVAILABLE.indexOf(currentMonth);
        currentMonth = MONTHS_AVAILABLE[(idx+1)%MONTHS_AVAILABLE.length];
        saveMonthPreference(currentMonth);
        setMonthLabel();
        rerender();
      });
    }

    function setupAgent(){
      const modal=document.getElementById("agentModal");
      const select=document.getElementById("agentShopSelect");
      const dateEl=document.getElementById("agentDate");
      const timeEl=document.getElementById("agentTime");
      const peopleEl=document.getElementById("agentPeople");
      const nameEl=document.getElementById("agentName");
      const notesEl=document.getElementById("agentNotes");
      const msgEl=document.getElementById("agentMessage");
      const copyBtn=document.getElementById("agentCopy");
      const makeBtn=document.getElementById("agentMakeMsg");
      const goBtn=document.getElementById("agentGoReserve");

      select.innerHTML = SHOPS.map(s=>`<option value="${s.id}">${escapeHTML(s.name)}</option>`).join("");

      function getSelectedShop(){ return SHOPS.find(s=>s.id===select.value) || SHOPS[0]; }
      function close(){ modal.setAttribute("aria-hidden","true"); }
      function open(shopId){
        modal.setAttribute("aria-hidden","false");
        if(shopId) select.value = shopId;
        if(!dateEl.value){ const d=new Date(); d.setDate(d.getDate()+7); dateEl.value=d.toISOString().slice(0,10); }
        if(!timeEl.value) timeEl.value="18:00";
        generate();
      }
      function generate(){
        const shop=getSelectedShop();
        const date=dateEl.value||"ï¼ˆæ—¥ä»˜æœªå…¥åŠ›ï¼‰";
        const time=timeEl.value||"ï¼ˆæ™‚é–“æœªå…¥åŠ›ï¼‰";
        const people=peopleEl.value||"2";
        const name=(nameEl.value||"").trim();
        const notes=(notesEl.value||"").trim();
        const lines=[
          `${shop.name} äºˆç´„å¸Œæœ›ã§ã™ã€‚`,
          `æ—¥æ™‚ï¼š${date} ${time}`,
          `äººæ•°ï¼š${people}å`,
          ...(name?[`åå‰ï¼š${name}`]:[]),
          ...(notes?[`è¦æœ›ï¼š${notes}`]:[]),
          `é€£çµ¡ï¼šã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«è¿”ä¿¡ãã ã•ã„ã€‚`
        ];
        msgEl.value = lines.join("\n");
      }
      function go(){
        const shop=getSelectedShop();
        const u=new URL(shop.reserveUrl || shop.url);
        if(dateEl.value) u.searchParams.set("date", dateEl.value);
        if(timeEl.value) u.searchParams.set("time", timeEl.value);
        if(peopleEl.value) u.searchParams.set("people", peopleEl.value);
        window.open(u.toString(), "_blank", "noopener");
      }

      document.addEventListener("click",(e)=>{
        const t=e.target;
        const openId=t?.getAttribute?.("data-open-agent");
        if(openId) open(openId);
        if(t?.getAttribute?.("data-close")==="1") close();
      });

      document.getElementById("openAgentFromHero").addEventListener("click",()=>open());
      document.getElementById("openAgentFromHeader").addEventListener("click",()=>open());
      makeBtn.addEventListener("click", generate);
      goBtn.addEventListener("click", ()=>{ generate(); go(); });

      copyBtn.addEventListener("click", async ()=>{
        try{ await navigator.clipboard.writeText(msgEl.value||""); copyBtn.textContent="ã‚³ãƒ”ãƒ¼æ¸ˆã¿"; setTimeout(()=>copyBtn.textContent="ã‚³ãƒ”ãƒ¼",1200); }
        catch{ alert("ã‚³ãƒ”ãƒ¼ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚"); }
      });

      [select,dateEl,timeEl,peopleEl,nameEl,notesEl].forEach(el=>{
        el.addEventListener("input", generate);
        el.addEventListener("change", generate);
      });
    }

    function setupHeroImage(){
      const hero=document.getElementById("heroMedia");
      const input=document.getElementById("heroUrl");
      const apply=document.getElementById("applyHero");
      const saved=localStorage.getItem("hero_image_url")||"";
      if(saved){ input.value=saved; setHero(saved); }

      function setHero(url){
        if(!url){ hero.style.backgroundImage=""; return; }
        hero.style.backgroundImage = `linear-gradient(180deg, rgba(0,0,0,.05), rgba(0,0,0,.55)), url('${url}')`;
        hero.style.backgroundSize="cover";
        hero.style.backgroundPosition="center";
      }

      apply.addEventListener("click", ()=>{
        const url=(input.value||"").trim();
        if(url && !/^https?:\/\//i.test(url)) return alert("ç”»åƒURLã¯ https:// ã‹ã‚‰å§‹ã¾ã‚‹URLã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚");
        localStorage.setItem("hero_image_url", url);
        setHero(url);
      });
    }

    (function init(){
      document.getElementById("tabTop").addEventListener("click", ()=>setTab("top"));
      document.getElementById("tabAll").addEventListener("click", ()=>setTab("all"));
      document.getElementById("scrollToList").addEventListener("click", ()=>{
        setTab("all");
        document.getElementById("sectionAll").scrollIntoView({behavior:"smooth", block:"start"});
      });

      setupMonthSwitcher();
      rerender();
      setupAgent();
      setupHeroImage();
      setMonthLabel();
    })();
  </script>
</body>
</html>
